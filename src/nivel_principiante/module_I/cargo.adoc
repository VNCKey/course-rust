= Cargo: CompilaciÃ³n y GestiÃ³n de Dependencias
:toc: left
:toclevels: 3
:sectnums:
:icons: font
:source-highlighter: rouge
:experimental:

== Â¿QuÃ© es Cargo?

*Cargo* es el sistema de compilaciÃ³n y gestor de paquetes oficial de Rust. Es una herramienta fundamental que simplifica todo el ciclo de desarrollo, desde la creaciÃ³n de proyectos hasta la gestiÃ³n de dependencias y la compilaciÃ³n.

Cargo se instala automÃ¡ticamente cuando instalas Rust a travÃ©s de `rustup`.

=== Â¿Por quÃ© es importante Cargo?

En otros lenguajes, necesitas mÃºltiples herramientas:

* *C/C++*: `make`, `cmake`, `pkg-config`
* *JavaScript*: `npm` o `yarn` + `webpack`
* *Python*: `pip` + `setuptools` + `virtualenv`

.*En Rust, Cargo lo hace todo:*
[%hardbreaks]
âœ… Crea y estructura proyectos
âœ… Compila tu cÃ³digo
âœ… Descarga y gestiona dependencias
âœ… Ejecuta tests
âœ… Genera documentaciÃ³n
âœ… Publica paquetes en https://crates.io[crates.io]

'''

== ğŸš€ Crear y explorar tu primer proyecto

=== Crear un nuevo proyecto

[source,bash]
----
# Crear un proyecto binario (aplicaciÃ³n)
cargo new mi_proyecto
----

.*Estructura generada:*
----
mi_proyecto/
â”œâ”€â”€ Cargo.toml          # Archivo de configuraciÃ³n
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.rs         # CÃ³digo fuente principal
â””â”€â”€ .gitignore          # Git configurado automÃ¡ticamente
----

=== Compilar el proyecto

[source,bash]
----
# CompilaciÃ³n en modo desarrollo (mÃ¡s rÃ¡pida, sin optimizaciones)
cargo build

# CompilaciÃ³n optimizada para producciÃ³n
cargo build --release
----

.*Diferencias clave:*
[cols="1,2,2,1,1", options="header"]
|===
|Modo
|Comando
|UbicaciÃ³n
|Velocidad
|OptimizaciÃ³n

|*Debug*
|`cargo build`
|`target/debug/`
|RÃ¡pida
|No

|*Release*
|`cargo build --release`
|`target/release/`
|Lenta
|SÃ­
|===

TIP: Usa `--release` solo cuando necesites mÃ¡ximo rendimiento (producciÃ³n, benchmarks).

=== Compilar y ejecutar

[source,bash]
----
# Compila y ejecuta automÃ¡ticamente
cargo run

# Con argumentos
cargo run -- arg1 arg2

# En modo release
cargo run --release
----

=== Verificar sin compilar completamente

[source,bash]
----
# Revisa errores sin generar el ejecutable (MUY rÃ¡pido)
cargo check
----

NOTE: `cargo check` es hasta 10x mÃ¡s rÃ¡pido que `cargo build` durante el desarrollo.

=== Limpiar archivos compilados

[source,bash]
----
# Elimina la carpeta target/
cargo clean
----

'''

== ğŸ“š GestiÃ³n de Dependencias

=== El archivo `Cargo.toml`

El corazÃ³n de tu proyecto. Define metadatos y dependencias:

[source,toml]
----
[package]
name = "mi_proyecto"
version = "0.1.0"
edition = "2021"
authors = ["Tu Nombre <tu@email.com>"]

[dependencies]
# AquÃ­ van las dependencias externas
----

=== AÃ±adir dependencias

.*Formato bÃ¡sico:*
[source,toml]
----
[dependencies]
serde = "1.0"
tokio = "1.35"
----

.*Con caracterÃ­sticas especÃ­ficas:*
[source,toml]
----
[dependencies]
tokio = { version = "1.35", features = ["full"] }
serde = { version = "1.0", features = ["derive"] }
----

.*Desde Git:*
[source,toml]
----
[dependencies]
mi_lib = { git = "https://github.com/usuario/repo" }
----

.*Dependencias locales:*
[source,toml]
----
[dependencies]
mi_lib = { path = "../mi_lib" }
----

=== Versiones y semÃ¡ntica

Cargo usa https://semver.org/[Semantic Versioning]:

[source,toml]
----
[dependencies]
# Exacta
serde = "=1.0.195"

# Compatible (recomendado) - permite 1.0.x
serde = "1.0"

# Rango
serde = ">=1.0, <2.0"

# Ãšltima versiÃ³n (NO recomendado en producciÃ³n)
serde = "*"
----

WARNING: `"1.0"` es equivalente a `"^1.0"` (caret), que permite actualizaciones compatibles (1.0.x, 1.1.x, etc.), pero NO 2.0.

=== Dependencias de desarrollo

Para testing y herramientas de desarrollo:

[source,toml]
----
[dev-dependencies]
criterion = "0.5"  # Para benchmarks
proptest = "1.4"   # Para property testing
----

Estas *NO* se incluyen en la compilaciÃ³n final del binario.

=== Actualizar dependencias

[source,bash]
----
# Actualizar segÃºn Cargo.toml (respetando semver)
cargo update

# Actualizar una dependencia especÃ­fica
cargo update -p serde

# Ver versiones disponibles
cargo search serde
----

'''

== ğŸ”§ Comandos Avanzados

=== Testing

[source,bash]
----
# Ejecutar todos los tests
cargo test

# Ejecutar tests especÃ­ficos
cargo test mi_test

# Mostrar output de println! en tests
cargo test -- --nocapture
----

=== DocumentaciÃ³n

[source,bash]
----
# Generar y abrir documentaciÃ³n
cargo doc --open

# Incluir dependencias
cargo doc --open --document-private-items
----

=== Benchmarks

[source,bash]
----
cargo bench
----

=== Publicar en crates.io

[source,bash]
----
# Verificar antes de publicar
cargo publish --dry-run

# Publicar
cargo publish
----

'''

== ğŸ“ Estructura del Proyecto

----
mi_proyecto/
â”œâ”€â”€ Cargo.toml           # ConfiguraciÃ³n del proyecto
â”œâ”€â”€ Cargo.lock           # Versiones exactas (Â¡no editar manualmente!)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs          # Punto de entrada (binario)
â”‚   â”œâ”€â”€ lib.rs           # Punto de entrada (biblioteca)
â”‚   â””â”€â”€ bin/             # MÃºltiples binarios
â”‚       â””â”€â”€ otro.rs
â”œâ”€â”€ tests/               # Tests de integraciÃ³n
â”‚   â””â”€â”€ integration_test.rs
â”œâ”€â”€ benches/             # Benchmarks
â”‚   â””â”€â”€ my_benchmark.rs
â”œâ”€â”€ examples/            # Ejemplos de uso
â”‚   â””â”€â”€ ejemplo.rs
â””â”€â”€ target/              # Archivos compilados (ignorar en Git)
----

=== Cargo.lock

[horizontal]
Binarios:: âœ… Commitear al repositorio
Bibliotecas:: âŒ AÃ±adir al `.gitignore`

Esto garantiza builds reproducibles en aplicaciones.

'''

== ğŸ’¡ Tips y Mejores PrÃ¡cticas

=== 1. Usa alias en `~/.cargo/config.toml`

[source,toml]
----
[alias]
b = "build"
r = "run"
t = "test"
c = "check"
----

Ahora puedes usar: `cargo c` en lugar de `cargo check`

=== 2. CompilaciÃ³n incremental

Cargo compila solo lo que cambiÃ³. Para forzar recompilaciÃ³n completa:

[source,bash]
----
cargo clean && cargo build
----

=== 3. Perfiles de compilaciÃ³n personalizados

En `Cargo.toml`:

[source,toml]
----
[profile.dev]
opt-level = 0  # Sin optimizaciÃ³n (rÃ¡pido)

[profile.release]
opt-level = 3     # MÃ¡xima optimizaciÃ³n
lto = true        # Link-Time Optimization
codegen-units = 1 # Mejor optimizaciÃ³n, compilaciÃ³n mÃ¡s lenta
----

=== 4. CaracterÃ­sticas opcionales

[source,toml]
----
[features]
default = ["feature1"]
feature1 = []
feature2 = ["dep:serde"]

[dependencies]
serde = { version = "1.0", optional = true }
----

Compilar con feature:
[source,bash]
----
cargo build --features "feature2"
----

'''

== ğŸ¯ Cheat Sheet

[cols="2,3", options="header"]
|===
|Comando
|DescripciÃ³n

|`cargo new <nombre>`
|Crear proyecto

|`cargo build`
|Compilar (debug)

|`cargo build --release`
|Compilar (optimizado)

|`cargo run`
|Compilar y ejecutar

|`cargo check`
|Verificar sin compilar

|`cargo test`
|Ejecutar tests

|`cargo clean`
|Limpiar target/

|`cargo update`
|Actualizar dependencias

|`cargo doc --open`
|Generar documentaciÃ³n

|`cargo add <crate>`
|AÃ±adir dependencia (Rust 1.62+)
|===

'''

== ğŸ”— Recursos Adicionales

* ğŸ“– https://doc.rust-lang.org/cargo/[DocumentaciÃ³n oficial de Cargo]
* ğŸ“¦ https://crates.io[Crates.io] - Repositorio de paquetes
* ğŸ” https://docs.rs[Docs.rs] - DocumentaciÃ³n de crates
* ğŸ“š https://doc.rust-lang.org/cargo/index.html[Cargo Book]

'''

[quote, Rust Community]
____
ğŸ¦€ *Recuerda*: Cargo es tu mejor amigo en Rust. Aprende a dominarlo y tu productividad se multiplicarÃ¡.
____

*Siguiente tema*: Variables y Mutabilidad (`let` y `let mut`) â†’
